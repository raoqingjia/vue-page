<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title></title>
</head>
<body>
<textarea>请输入内容hellip;</textarea>
<input type="button" value="插入str" onClick="test('str');" />
<p>string.substring(from, to)<br />string.slice(start, end)<br />这两个方法差不多，都是指定开始和结束位置返回新字符串，在参数均为正整数的时候返回结果一样，当参数为负整数的时候，string.substring(from, to)把负整数都当作0处理，而string.slice(start, end)将把负整数加上该字符串的长度处理<br />string.substr(start, length)<br />这个方法只在第二个参数上指定的是新字符串的长度，对于负正数和string.slice(start, end)处理一样，把负整数加上原字符串的长度</p>
<script>
  function test(str){
    var el = document.getElementsByTagName('textarea')[0];
    var len = el.value.length;
    el.focus();
    //只ie认document.selection
    console.log(document.selection);
    if (!document.selection) {
      //不会替换选中文本，光标处插入，插入后光标定位到了文本末
      alert(el.selectionStart);
      el.value = el.value.substr(0, el.selectionStart) + str + el.value.substring(el.selectionStart, len);
      alert(el.selectionStart);
    } else {
      //替换选中文本，光标处插入，插入后光标停留在了原位置
      document.selection.createRange().text = str;
    }
  }
</script>
</body>
</html>
