<template>
  <div class="article inner">
    <div class="content">
      <div class="wrap">
        <h2 class="art-title" v-html="title"></h2>
        <p class="art-time">
          <span v-html="created"></span>
        </p>
        <div class="art-content">
          <ul class="catalogue">
            <li v-for="(items,index) in catalogue"><a @click="jump(index)">{{index+1}}ã€{{items.name}}</a></li>
          </ul>
          <h3>ç›¸å…³èµ„æ–™åŠé“¾æ¥</h3>
          <pre>
å“åº”å¼ç¼–ç¨‹ï¼ˆReactive Programmingï¼‰ï¼Œé¡¾åæ€ä¹‰ï¼ŒæŒ‡é€šè¿‡å£°æ˜å¼çš„è®¾è®¡æŒ‡å®šæ•°æ®ä¾èµ–å…³ç³»ï¼Œå¹¶ä¸”ä»…ä»¥æœ€å°æˆæœ¬åº”å¯¹å¤–ç•Œä¾èµ–çš„å˜åŒ–è¿›è¡Œç›¸åº”çš„æ•°æ®å¤„ç†ã€‚ä¸€ä¸ªä¸æ˜¯ååˆ†æ°å½“çš„ç®€å•ç‰ˆæœ¬æ˜¯ï¼Œéå“åº”å¼ç¼–ç¨‹æ˜¯åŸºäºæ‹‰å–ï¼ˆPullï¼‰ï¼Œè€Œå“åº”å¼ç¼–ç¨‹æ˜¯åŸºäºæ¨é€ï¼ˆPushï¼‰ã€‚
3.0 æ–°åŠ å…¥äº† TypeScript ä»¥åŠ PWA çš„æ”¯æŒ
éƒ¨åˆ†å‘½ä»¤å‘ç”Ÿäº†å˜åŒ–ï¼š
ä¸‹è½½å®‰è£… npm install -g vue@cli
åˆ é™¤äº†vue list
åˆ›å»ºé¡¹ç›® vue create
å¯åŠ¨é¡¹ç›® npm run serve
é»˜è®¤é¡¹ç›®ç›®å½•ç»“æ„ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ï¼š
ç§»é™¤äº†é…ç½®æ–‡ä»¶ç›®å½•ï¼Œconfig å’Œ build æ–‡ä»¶å¤¹
ç§»é™¤äº† static æ–‡ä»¶å¤¹ï¼Œæ–°å¢ public æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸” index.html ç§»åŠ¨åˆ° public ä¸­
åœ¨ src æ–‡ä»¶å¤¹ä¸­æ–°å¢äº† views æ–‡ä»¶å¤¹ï¼Œç”¨äºåˆ†ç±» è§†å›¾ç»„ä»¶ å’Œ å…¬å…±ç»„ä»¶
.LifeCycle(Hooks) 3.0å½“ä¸­çš„ç”Ÿå‘½å‘¨æœŸä¸2.0çš„ç”Ÿå‘½å‘¨æœŸå‡ºç°äº†å¾ˆå¤§çš„ä¸åŒï¼š

https://vue-next-template-explorer.netlify.app/   VUE3 ä»£ç åº•å±‚ä»£ç å±•ç¤º
https://www.yuque.com/along-n3gko/ezt5z9  é›€äº‘å‰ç«¯æŠ€æœ¯æ ˆ
https://dxmo.gitee.io/  æå—æ±Ÿvue3ç¬”è®°è®²è§£</pre>
          <h3>Vue3æ˜¯å¦‚ä½•å˜å¿«çš„</h3>
          <pre>
1ï¼‰é™æ€æ ‡è®°
vue2.0 diff ç®—æ³•æ˜¯å…¨é‡æ¯”å¯¹ï¼Œvue3.0 çš„diffç®—æ³•æ˜¯ä¼šå†åˆ›å»ºè™šæ‹ŸDOMçš„æ—¶å€™å›æ ¹æ®DOMä¸­çš„å†…å®¹ä¼šä¸ä¼šå˜åŒ–ï¼Œæ·»åŠ é™æ€æ ‡è®°(PatchFlag)ï¼Œç±»ä¼¼å†™æ­»çš„æ–‡æœ¬å’Œæ ·å¼å°±ä¸ä¼šæ·»åŠ é™æ€æ ‡è®°ï¼ŒåŠ¨æ€å˜åŒ–çš„ä¸œè¥¿åè€Œå«é™æ€æ ‡è®°ï¼Œé€šè¿‡æ–°å¢é™æ€æ ‡è®°ï¼ˆPatchFlagï¼‰ï¼Œåªæ¯”å¯¹å¸¦æœ‰ PF çš„èŠ‚ç‚¹å¹¶ä¸”é€šè¿‡ Flag çš„ä¿¡æ¯å¾—çŸ¥å½“å‰èŠ‚ç‚¹è¦æ¯”å¯¹çš„å…·ä½“å†…å®¹

2ï¼‰hoistStaticé™æ€æå‡
vue2æ— è®ºåŸå§‹æ˜¯å¦å‚ä¸æ›´æ–°ï¼Œæ¯æ¬¡éƒ½ä¼šé‡æ–°åˆ›å»ºï¼Œç„¶åå†æ¸²æŸ“ï¼Œvue3 å¯¹äºä¸å‚ä¸æ›´æ–°çš„å…ƒç´ ï¼Œä¼šåšé™æ€æå‡ï¼Œåªä¼šè¢«åˆ›å»ºä¸€æ¬¡ï¼Œä»¥åæ¯æ¬¡è¿›è¡Œrenderçš„æ—¶å€™ï¼Œå°±ä¸ä¼šé‡å¤åˆ›å»ºè¿™äº›é™æ€çš„å†…å®¹ï¼Œè€Œæ˜¯ç›´æ¥ä»ä¸€å¼€å§‹å°±åˆ›å»ºå¥½çš„å¸¸é‡ä¸­å–å°±è¡Œäº†

3ï¼‰äº‹ä»¶ä¾¦å¬å™¨ç¼“å­˜
é»˜è®¤æƒ…å†µä¸‹onClickä¼šè¢«è§†ä¸ºåŠ¨æ€ç»‘å®šï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½ä¼šå»è¿½è¸ªå®ƒçš„å˜åŒ–ï¼Œä½†æ˜¯å› ä¸ºæ˜¯åŒä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥æ²¡å¿…è¦å»è¿½è¸ªå®ƒçš„å˜åŒ–ï¼Œæƒ³åŠæ³•å°†å®ƒç›´æ¥ç¼“å­˜èµ·æ¥å¤ç”¨å°±ä¼šæå‡æ€§èƒ½ï¼Œvue3ä¸­çš„ cacheHandler ä¼šå°†æ–¹æ³•æ ‡è®°ï¼Œåœ¨ä½¿ç”¨ä¸­å¦‚æœèƒ½åœ¨ç¼“å­˜ä¸­æ‰¾åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒå°†ç›´æ¥è¢«ä½¿ç”¨ã€‚å¦‚æœæ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆå°†è¿™ä¸ªæ–¹æ³•æ³¨å…¥ç¼“å­˜ã€‚æ€»ä¹‹ï¼Œå°±æ˜¯æŠŠæ–¹æ³•ç»™ç¼“å­˜äº†
</pre>
          <h3>Composition API</h3>
          <pre>
å› ä¸ºåŸæœ‰vue2çš„Vue OptionsAPI åˆ†äº†data ï¼Œ method ï¼Œwatch  ï¼Œ computed å®é™…å¼€å‘ä¸­è¿˜è¦æ»šåŠ¨æ¡åå¤ä¸Šä¸‹ç§»åŠ¨ï¼Œä¸šåŠ¡æ•°æ®é€»è¾‘åˆ†æ•£ï¼Œä¸åˆ©äºç®¡ç†å’Œç»´æŠ¤,åœ¨æ–°ç‰ˆvue3çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå¯ä»¥æŒ‰éœ€å¯¼å…¥åˆ°ç»„ä»¶ä¸­ï¼Œä¸”åªèƒ½åœ¨setup()å‡½æ•°ä¸­ä½¿ç”¨

ç”Ÿå‘½å‘¨æœŸ2.xä¸Compositionä¹‹é—´çš„æ˜ å°„å…³ç³»
â€¢ beforeCreate -> use setup()
â€¢ created -> use setup()
â€¢ beforeMount -> onBeforeMount
â€¢ mounted -> onMounted
â€¢ beforeUpdate -> onBeforeUpdate
â€¢ updated -> onUpdated
â€¢ beforeDestroy -> onBeforeUnmount
â€¢ destroyed -> onUnmounted
â€¢ errorCaptured -> onErrorCaptured

setupæ³¨æ„ç‚¹ï¼š
setup()å‡½æ•°æ˜¯vue3ä¸­ä¸“é—¨æ–°å¢çš„æ–¹æ³•ï¼Œå¯ä»¥ç†è§£ä¸ºComposition Apiçš„å…¥å£.
setupçš„æ‰§è¡Œæ—¶æœºæ˜¯åœ¨beforeCreateé’©å­ä¹‹å‰å®Œæˆçš„
beforeCreateï¼šè¡¨ç¤ºç»„ä»¶åˆšåˆšåˆ›å»ºï¼Œç»„ä»¶çš„dataå’Œmethodsè¿˜æ²¡æœ‰åˆå§‹åŒ–
Createdï¼š è¡¨ç¤ºç»„ä»¶åˆšåˆšè¢«åˆ›å»ºå‡ºæ¥ï¼Œå¹¶ä¸”ç»„ä»¶çš„dataå’Œmethodså·²ç»åˆå§‹åŒ–å¥½
ç”±äºæ‰§è¡Œsetupå‡½æ•°çš„æ—¶å€™ï¼Œè¿˜æ²¡æœ‰æ‰§è¡ŒbeforeCreateç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œæ‰€ä»¥setupå‡½æ•°ä¸­æ˜¯é™¤äº† props ä¹‹å¤–ï¼Œæ— æ³•ä½¿ç”¨dataå’Œmethodsçš„ï¼Œç”±äºsetupå‡½æ•°
æ— æ³•ä½¿ç”¨dataå’Œmethodsï¼Œvue3ä¸­ç›´æ¥å°†setupä¸­çš„thisæ›´æ”¹ä¸ºäº†undefinedï¼Œsetupåªèƒ½æ˜¯åŒæ­¥çš„ä¸èƒ½æ˜¯å¼‚æ­¥çš„ï¼Œ async setup(){} è¿™ç§å†™æ³•æ— ç”¨

æ¥æ”¶propsæ•°æ®
export default {
  props: {
    msg: {
      type: String,
      default: () => {}
    }
  },
  setup(props) {
  	console.log(props);
  }
}</pre>
          <h3>refä¸reactiveçš„ç”¨æ³•ä¸åŒºåˆ«</h3>
          <pre>ä»€ä¹ˆæ˜¯reactive
Vue3.0ä¸­è¿˜ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå¯¹è±¡å¼å“åº”çš„reactiveå‡½æ•° ã€‚
Reactiveå‡½æ•°åˆ›å»ºä¸€ä¸ªå“åº”å¼å¯¹è±¡ã€‚å…¶å®ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œreactiveå‡½æ•° å°±æ˜¯VUE3.0ä¸ºæˆ‘ä»¬æä¾›çš„æ›¿ä»£VUE2.0ä¸­dataçš„ä¸€ä¸ªå‡½æ•°ï¼Œå› æ­¤ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä¸å»ºè®®å°†æ–¹æ³•ä¹Ÿå†™åˆ°reactiveå‡½æ•°ä¸­ã€‚reactiveå‡½æ•° ä¸­åªå†™æ•°æ®å³å¯ã€‚

Vue2.x vs Vue3.x
Vue2ä¸­å“åº”å¼æ˜¯é€šè¿‡definePropertyå®ç°çš„
Vue3ä¸­å“åº”å¼æ˜¯é€šè¿‡ES6çš„Proxyå®ç°çš„
Vue3ä¸­å®ç°å“åº”å¼æ•°æ®çš„æ–¹æ³•æ˜¯refå’Œreactive

ç‰¹ç‚¹
reactiveçš„å‚æ•°ä¸€èˆ¬æ˜¯å¯¹è±¡æˆ–è€…æ•°ç»„,ä»–èƒ½å¤Ÿå°†å¤æ‚æ•°æ®ç±»å‹å˜ä¸ºå“åº”å¼æ•°æ®ã€‚
reactiveçš„å“åº”å¼æ˜¯æ·±å±‚æ¬¡çš„ï¼Œåº•å±‚æœ¬è´¨æ˜¯å°†ä¼ å…¥çš„æ•°æ®è½¬æ¢ä¸ºProxyå¯¹è±¡
ä½¿ç”¨æ–¹æ³•
< div>
   < h2>{ { data.name}}< /h2>
   < p>{ { data.age}}< /p>
< /div>
import { reactive } from 'vue'
export default {
  name: 'App',
  setup () {
    const data  = reactive({
      name: 'frank',
      age: 18
    })
    const handleChange = () => {
      data.name = 'mike';
      data.age = 20;
    }
    return { data , handleChange }
  }
}
ä¸»è¦æœ‰è¿™å‡ ä¸ªåŒºåˆ«ï¼š
1ï¼šåœ¨jsä¸­è°ƒç”¨éœ€è¦ä½¿ç”¨data.å±æ€§æ¥èµ‹å€¼ä½¿ç”¨ã€‚
2ï¼šåœ¨VUEæ¨¡æ¿è¯­æ³•ä¸­ï¼Œä¹Ÿéœ€è¦ä½¿ç”¨data.å±æ€§æ¥èµ‹å€¼ä½¿ç”¨ã€‚

å¼•ç”³æå‰è¯´ä¸€ä¸‹toRefså‡½æ•°
æ¨¡æ¿è¯­æ³•ä¸­éœ€è¦ä½¿ç”¨data.å±æ€§æ¥è°ƒç”¨å±æ€§æ˜¾ç¤ºï¼Œç›¸å¯¹æ¥è¯´å°±æ¯”è¾ƒéº»çƒ¦ã€‚
å…¶å®æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ES6ä¸­çš„æ‰©å±•è¿ç®—ç¬¦æ¥å¯¹å…¶è¿›è¡Œè§£æ„å¤„ç†ï¼Œä½†æ˜¯ï¼Œè¿™æ ·å§è§£æ„ä¹‹åï¼Œä¾¿ä¸å†å…·æœ‰å“åº”å¼çš„å±æ€§ï¼Œè¿™ä¸ªä¸è¡Œã€‚
VUE3.0ä¸ºæˆ‘ä»¬æä¾›äº†toRefså‡½æ•°å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
import {ref,reactive,toRefs} from "vue";
< template>
  < h1>{ { msg }}< /h1>
  < button @click="count++">count is: { { count }}< /button>
  < button @click="clickMe()">ç‚¹æˆ‘å¼¹çª—< /button>
< /template>
< script lang='ts'>
import {
  ref,
  reactive,
  toRefs
} from "vue";
export default {
  name: 'HelloWorld',
  props: {
    msg: String
  },
  // ä½¿ç”¨setup ä»£æ›¿ data
  // å› ä¸ºæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯typescriptï¼Œå› æ­¤éœ€è¦ç»™å‚æ•°æŒ‡å®šç±»å‹
  setup(props:any,context:any){
    // ref å®šä¹‰å“åº”å¼æ•°æ®
    // let count = ref(0);

    // reactive åˆ›å»ºå“åº”å¼å¯¹è±¡
    let data = reactive({
      // å®šä¹‰å“åº”å¼æ•°æ®
      count:0,
    });

    const clickMe = () => {
      // ä½¿ç”¨refå…³é”®å­—ç»‘å®šçš„å˜é‡ï¼Œèµ‹å€¼ çš„æ—¶å€™å¿…é¡»ä½¿ç”¨.value
      // count.value++;
      // è°ƒç”¨reactive å®šä¹‰å¯¹è±¡çš„å‚æ•°çš„æ—¶å€™éœ€è¦ä½¿ç”¨å¯¹è±¡.æ¥è°ƒç”¨
      data.count++;
    }
    // ä½¿ç”¨toRefså‡½æ•°å¯¹dataå¯¹è±¡è¿›è¡ŒåŒ…è£…ï¼Œç¡®ä¿ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦è¿›è¡Œè§£æ„ä¹‹åï¼Œä»å…·æœ‰å“åº”å¼
    let param = toRefs(data);
    return {
      // data,
      ...param,
      clickMe
    }
  },
}
< /script>

Proxy vs defineProperty
reactiveæ–¹æ³•å†…éƒ¨æ˜¯åˆ©ç”¨ES6çš„Proxy APIæ¥å®ç°çš„ï¼Œè¿™é‡Œä¸Vue2ä¸­çš„definePropertyæ–¹æ³•æœ‰æœ¬è´¨çš„åŒºåˆ«ã€‚
definePropertyåªèƒ½å•ä¸€åœ°ç›‘å¬å·²æœ‰å±æ€§çš„ä¿®æ”¹æˆ–è€…å˜åŒ–ï¼Œæ— æ³•æ£€æµ‹åˆ°å¯¹è±¡å±æ€§çš„æ–°å¢æˆ–åˆ é™¤ï¼Œè€ŒProxyå¯ä»¥è½»æ¾å®ç°
definePropertyæ— æ³•ç›‘å¬å±æ€§å€¼æ˜¯æ•°ç»„ç±»å‹çš„å˜åŒ–ï¼Œè€ŒProxyå¯ä»¥è½»æ¾å®ç°

ref
ç‰¹ç‚¹
refçš„å‚æ•°ä¸€èˆ¬æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ç±»å‹
å¦‚æœå‚æ•°æ˜¯å¯¹è±¡ç±»å‹ï¼Œå…¶å®åº•å±‚çš„æœ¬è´¨è¿˜æ˜¯reactiveï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°†refè½¬æ¢ä¸ºreactiveï¼Œä¾‹å¦‚
ref(1) ===> reactive({value:1})
åœ¨æ¨¡æ¿ä¸­è®¿é—®refä¸­çš„æ•°æ®ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æ·»åŠ .value,åœ¨JSä¸­è®¿é—®refä¸­çš„æ•°æ®ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ .value
refçš„åº•å±‚åŸç†åŒreactiveä¸€æ ·ï¼Œéƒ½æ˜¯Proxy

ä½¿ç”¨æ–¹æ³•
< template>
	< h1>{ { name }}< /h1>
	< h1>{ { age }}< /h1>
< /template>
< script>
import { ref} from 'vue'
export default {
  name: 'App',
  setup () {
    const name = ref('frank')
    const age = ref(18)
    const handleChange = () => {
      name.value = 'mike'
      age.value = 20
    }
    return { name, age, handleChange }
  }
}
< /script>

reactive vs ref
reactiveå‚æ•°ä¸€èˆ¬æ¥å—å¯¹è±¡æˆ–æ•°ç»„ï¼Œæ˜¯æ·±å±‚æ¬¡çš„å“åº”å¼ã€‚refå‚æ•°ä¸€èˆ¬æ¥æ”¶ç®€å•æ•°æ®ç±»å‹ï¼Œè‹¥refæ¥æ”¶å¯¹è±¡ä¸ºå‚æ•°ï¼Œæœ¬è´¨ä¸Šä¼šè½¬å˜ä¸ºreactiveæ–¹æ³•
åœ¨JSä¸­è®¿é—®refçš„å€¼éœ€è¦æ‰‹åŠ¨æ·»åŠ .valueï¼Œè®¿é—®reactiveä¸éœ€è¦
å“åº”å¼çš„åº•å±‚åŸç†éƒ½æ˜¯Proxy</pre>
          <h3>shallowRefã€shallowReactive é€’å½’ç›‘å¬</h3>
          <pre>å…¶å®è¿™ä¸¤ä¸ªå‡½æ•°å¹¶ä¸æ˜¯å¾ˆå¸¸ç”¨ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­åŸºæœ¬ä¸Šç”¨ä¸åˆ°ï¼Œâ€˜è¿™é‡Œç¬”è®°å¯ä»¥è·³è¿‡â€™ã€‚
æ— è®º ref å‡½æ•°è¿˜æ˜¯ reactive å‡½æ•°éƒ½æ˜¯æ·±åº¦ç›‘å¬ã€‚
å¦‚æœæ•°æ®é‡è¿‡å¤§ï¼Œè¶…çº§è¶…çº§æ¶ˆè€—æ€§èƒ½ã€‚
å¦‚æœæˆ‘ä»¬ä¸éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ·±åº¦ç›‘å¬çš„æ—¶å€™ï¼Œå°±å¯ä»¥ä½¿ç”¨ shallowRef å‡½æ•°å’Œ shallowReactive å‡½æ•°ã€‚

éæ·±åº¦ç›‘å¬
shallowReactive æ˜¯ç›‘å¬ç¬¬ä¸€å±‚æ•°æ®æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœå‘ç”Ÿå˜åŒ–åˆ™ä»æ–°æ¸²æŸ“æ•´ä¸ªç•Œé¢ï¼Œå¦‚æœæ˜¯ç¬¬äºŒå±‚æ•°æ®å‘ç”Ÿå˜åŒ–åˆ™ä¸æ¸²æŸ“ç•Œé¢
shallowRef ä¸­çš„æœ€å¤–å±‚æ˜¯ value ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½æ”¹å˜æ•´ä¸ª value å€¼æ¥æé†’å˜åŒ–ï¼ŒshallowRefçš„æœ¬è´¨æ˜¯ç›‘å¬.valueçš„å€¼

ä»£ç ç¤ºä¾‹è¯´æ˜ä¸€ä¸‹ shallowReactive
å‡è®¾æˆ‘ä»¬é¡µé¢æœ‰ä¸€ä¸ªä¸ªäººä¿¡æ¯å±•ç¤ºï¼Œæœ‰åå­—ã€æœ‰å¹´é¾„éœ€è¦å±•ç¤ºï¼Œæˆ‘ä»¬æ•°æ®æ˜¯å­˜åœ¨ boy å¯¹è±¡é‡Œé¢ï¼Œç„¶å age æ˜¯åœ¨ boy å¯¹è±¡çš„ news å±æ€§ä¸‹é¢ï¼Œä¹Ÿå°±æ˜¯æ·±å±‚ï¼Œä½†æ˜¯ name æ˜¯åœ¨ boy å¯¹è±¡ä¸‹é¢ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€å±‚ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªæŒ‰é’®ï¼Œåˆ†åˆ«ä¿®æ”¹ name å’Œ ageï¼Œçœ‹ä¸€ä¸‹ä¼šæœ‰ä»€ä¹ˆæ•ˆæœã€‚
template>
  < div>
    < h1>å§“åï¼š{ {name}}< /h1>
    < h1>å¹´é¾„ï¼š{ {news.age}}< /h1>
    < button @click="btn">ä¿®æ”¹name< /button>
    < button @click="btn2">ä¿®æ”¹age< /button>
  < /div>
< /template>
< script>
import { shallowReactive, toRefs } from "vue";
export default {
  name: "App",
  setup() {
    const boy = shallowReactive({
      name: "æˆ‘æ˜¯ğ’†ğ’….",
      news: {
        birthday: "2012-10-14",
        age: 10
      }
    });
    const btn = () => {
      boy.name = "ğ’†ğ’….";
    };
    const btn2 = () => {
      boy.news.age++;
    };
    return { ...toRefs(boy), btn, btn2 };
  }
};
< /script>
ç‚¹å‡»btné¡µé¢å‘ç”Ÿå˜åŒ–ï¼Œç‚¹å‡»btn2é¡µé¢ä¸å˜åŒ–
shallowReactive æ˜¯ç›‘å¬ç¬¬ä¸€å±‚æ•°æ®æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœæ˜¯ç¬¬äºŒå±‚æ•°æ®å‘ç”Ÿå˜åŒ–åˆ™ä¸æ¸²æŸ“ç•Œé¢

æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡triggerRef()æ‰‹åŠ¨å»è§¦å‘ ref çš„å˜åŒ–ç›‘å¬äº‹ä»¶æ¥å®ç°ç•Œé¢çš„æ”¹å˜ï¼Œä½†æ˜¯ç¡®æ²¡æœ‰triggerReactiveè¿™ç§æ–¹æ³•ï¼Œå½“refçš„åº•å±‚æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œå¯é€šè¿‡triggerRef()ä»¤æ•´ä¸ªç•Œé¢å˜åŒ–
shallowRef å’Œ triggerRef() ä¸å•ç‹¬ç»†è®²äº†ä¸Šç½‘æœå§ï¼Œå·¥ä½œä¸­å‡ ä¹ç”¨ä¸ç€</pre>
          <h3>customRef ç”¨äºè‡ªå®šä¹‰ ref</h3>
          <pre> äº†è§£å°±è¡Œï¼Œå·¥ä½œä¸­ç”¨å¤„ä¸å¤§
æœ‰çš„ ref å¯ä»¥ä¸è§†å›¾å±‚å®ç°åŒå‘æ•°æ®ç»‘å®šï¼Œè€Œæœ‰çš„åˆ™ä¸èƒ½ã€‚å‡å¦‚æˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰ä¸€ä¸ª ref ï¼Œå½“è¿™ä¸ª ref ç›‘å¬çš„æ•°æ®å˜åŒ–æ—¶ï¼Œæ‰§è¡Œæˆ‘ä»¬è‡ªå·±å®šä¹‰çš„æ–¹æ³•ï¼Œå°±åƒæ˜¯ watchfEffect ä¸€æ ·å»æ£€æµ‹ä¸€ä¸ªæ•°æ®ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ customRef
#ç¤ºä¾‹
import { customRef } from 'vue';
function myRef(value) {
    // customer éœ€è¦æä¾›ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°è¯¥å‡½æ•°é»˜è®¤å¸¦å‚æ•° track å’Œ trigger ï¼Œéƒ½æ˜¯æ–¹æ³•ã€‚
    return customRef((track, trigger) => {
      return {
        // customer éœ€è¦æä¾›ä¸€ä¸ªå¯¹è±¡ ä½œä¸ºè¿”å›å€¼,è¯¥å¯¹è±¡éœ€è¦åŒ…å« get å’Œ set æ–¹æ³•ã€‚
        get() {
          track();   // ç”¨äºæç¤ºvueè¿™ä¸ªæ•°æ®æ˜¯éœ€è¦è¿½è¸ªå˜åŒ–çš„
          console.log('get', value);  // get æ–¹æ³•éœ€è¦è¿”å›å€¼ï¼Œä¸€èˆ¬å°±æ˜¯ valueï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚
          return value;
        },
        // set ä¼ å…¥ä¸€ä¸ªå€¼ä½œä¸ºæ–°å€¼ï¼Œé€šå¸¸ç”¨äºå–ä»£ value
        set(newValue) {
          console.log('set', newValue);
          value = newValue;
          trigger();        //  å‘Šè¯‰vueè§¦å‘ç•Œé¢æ›´æ–°
        }
      }
    })
}
export default {
  name: 'App',
  setup() {
    // åº”ç”¨ä¸Šé¢çš„è‡ªå®šä¹‰ ref ï¼Œä½¿ç”¨æ–¹æ¡ˆå’Œä¹‹å‰çš„ ref æ˜¯ç±»ä¼¼çš„ã€‚
    const obj = myRef(123);
    return {
      obj
    };
  }
}</pre>
          <h3>toRef ã€toRefs åœ°å€æŒ‡å‘é—®é¢˜</h3>
          <pre>æ­£å¸¸å†™æ³•
< template>
    < div>
        < h2> äººçš„ä¿¡æ¯< /h2>
        < p>å§“å { {person.name}}< /p>
        < p>å¹´é¾„ { {person.age}}< /p>
        < p>æ€§åˆ« { {person.sex}}< /p>
        < p>å·¥ä½œè¯¦æƒ…  å†…å®¹{ {person.job.position}} è–ªèµ„{ {person.job.salary}}< /p>
    < /div>
< /template>
script>
export default {
  setup() {
    let person = reactive({
      name:'å¼ ä¸‰',
      age:18,
      sex:'ç”·',
      job:{
        position:'UIå¼€å‘',
        salary:'20K'
      }
    })
    return {
      person,
    }
  },
};
< /script>
è¿ç”¨toRefçš„å†™æ³•
< template>
  < div>
      < h2> äººçš„ä¿¡æ¯< /h2>
      < p>å§“å { {name}}< /p>
      < p>å¹´é¾„ { {age}}< /p>
      < p>æ€§åˆ« { {sex}}< /p>
      < p>å·¥ä½œè¯¦æƒ…  å†…å®¹{ {position}} è–ªèµ„{ {salary}}< /p>
  < /div>
< /template>
< script>
import { reactive,toRef} from 'vue';
export default {
  setup() {
    let person = reactive({
      name:'å¼ ä¸‰',
      age:18,
      sex:'ç”·',
      job:{
        name:'UIå¼€å‘',
        salary:'20K'
      }
    })
    return {
      name:toRef(person,'name'),
      age:toRef(person,'age'),
      sex:toRef(person,'sex'),
      position:toRef(person.job,'position'),
      salary:toRef(person.job,'salary'),
    }
  },
};
< /script>

è¿ç”¨toRefsçš„å†™æ³•
< template>
  < div>
      < h2> äººçš„ä¿¡æ¯< /h2>
      < p>å§“å { {name}}< /p>
      < p>å¹´é¾„ { {age}}< /p>
      < p>æ€§åˆ« { {sex}}< /p>
      < p>å·¥ä½œ{ {job.position}} è–ªèµ„{ {job.salary}}< /p>
  < /div>
< /template>
< script>
import { reactive,toRefs } from 'vue';
export default {
  setup() {
    let person = reactive({
      name:'å¼ ä¸‰',
      age:18,
      sex:'ç”·',
      job:{
        position:'UIå¼€å‘',
        salary:'20K'
      }
    })
    return {
      ...toRefs(person)
    }
  },
};
< /script>
æ€»ç»“:toRefæ˜¯æ™ºèƒ½ä¸€ä¸ªè½¬æ¢ï¼ŒtoRefsæ˜¯å…¨éƒ¨è½¬æ¢ã€‚ç±»ä¼¼äºå‰ç«¯çš„æ·±æ‹·è´å’Œæµ…æ‹·è´ã€‚toRefsæ‹·è´å‡ºæ¥çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥è¦ç”¨è§£æ„è¯­æ³•è§£æ„ä»–ã€‚å¹¶ä¸”toRefsæ‹·è´å‡ºæ¥çš„å¤–é¢é‚£ä¸€å±‚ï¼Œé‡åˆ°å¤æ‚çš„è¿˜è¦æ…¢æ…¢æ‰¾åˆ°ä»–è¿™ä¸ªå˜é‡</pre>
          <h3>çˆ¶ç»„ä»¶ä¸å­ç»„ä»¶ä¹‹é—´çš„æ•°æ®ä¼ é€’</h3>
          <pre>
1ã€çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ è¾“æ•°æ®æ–¹å¼ä¸€
provideå’Œinjectå¯ä»¥å®ç°åµŒå¥—ç»„ä»¶å…±äº«æ•°æ®.è¿™ä¸¤ä¸ªå‡½æ•°åªèƒ½åœ¨setup()å‡½æ•°ä¸­ä½¿ç”¨ã€‚çˆ¶çº§ç»„ä»¶ä¸­ä½¿ç”¨provide()å‡½æ•°å‘ä¸‹ä¼ é€’æ•°æ®ï¼›å­çº§ç»„ä»¶ä½¿ç”¨inject()è·å–ä¸Šå±‚ä¼ é€’çš„æ•°æ®.è¿™ä¸ªæ˜¯å¯ä»¥æ— é™å‘ä¸‹å±‚ç»„ä»¶ä¼ é€’.
è¿™ä¸ªæ•°æ®ä¼ é€’æœ‰ä¸ªé—®é¢˜ï¼Œå¦‚æœæœ‰å¤šä¸ªç»„ä»¶ï¼Œä¼ é€’çš„å˜é‡åå­—éƒ½å«ä¸€ä¸ªåå­—ï¼Œä¸”ç»“æ„ä½“ä¸ä¸€è‡´å°±ä¼šå‡ºç°é—®é¢˜
çˆ¶ç»„ä»¶
import { provide } from 'vue';
import Test from "./test2";
export default {
  components: { Test },
  setup () {
    provide('info', {
      name: 'along',
      age: 18,
      sex: 'ç”·'
    })
  }
};
å­ç»„ä»¶ç”¨injectæ¥æ”¶ä¼ è¾“å‚æ•°
import { inject } from 'vue';
export default {
  setup () {
    const info = inject('info'); //{name: "along", age: 18, sex: "ç”·"}
  }
};
2ã€çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ è¾“æ•°æ®æ–¹å¼äºŒ
å­ç»„ä»¶Buttonså®šä¹‰propsæ¥æ”¶å‚æ•°
export default defineComponent({
  name: "Buttons",
  props: {
      btnType: {
          type: Number,
          required: true,
          default() {
              return 1;
          }
      },
      style: {
          type: Object,
          required: false,
          default() {
              return {};
          }
      }
  },
  setup(props, context) {}
})
çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ å€¼
< template>
  < Buttons :btn-type='btnItem.btnType'  :style='btnItem.style'>< /Buttons>
< /template>
export default defineComponent({
    setup(props, context) {
        const btnItem = {
           btnType:...,
           style :...
        }
        return{
            btnItem
        }
    }
})
2ã€å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ å€¼
< template>
    < button @click="search">æŸ¥è¯¢< /button>
< /template>
 export default defineComponent({
    name: 'QueryConditions',
    emits: {
        "filterResult": null,
    },
    setup(props, {emit}) {
      const search = ()=>{
         emit("filterResult",{data:'ä¼ ä¸ªçˆ¶ç»„ä»¶çš„å€¼'});
      }
    },
    return{
      search
    }
   }
})
çˆ¶ç»„ä»¶å†…å®šä¹‰æ–¹æ³•æ¥æ”¶ä¼ å€¼
< template>
 < QueryConditions @filterResult="setTableData">< /QueryConditions>
< /template>
export default defineComponent({
  setup(props, context) {
     const setTableData = (data: any) => {
        console.log(data); //  æ¥æ”¶å­ç»„ä»¶çš„ä¼ å€¼
     }
      return{
          btnItem
      }
  }
})
3ã€çˆ¶ç»„ä»¶è§¦å‘å­ç»„ä»¶æ–¹æ³•
å®šä¹‰å­ç»„ä»¶
< template>
    < button @click="sonFun">æŸ¥è¯¢< /button>
< /template>
 export default defineComponent({
    name: 'QueryConditions',
    setup(props, {emit}) {
      const sonFun = ()=>{
        alert('å¯ä»¥è¢«çˆ¶ç»„ä»¶è§¦å‘');
      }
    },
    return{
      sonFun
    }
   }
})
çˆ¶ç»„ä»¶åˆ©ç”¨refè§¦å‘å­ç»„ä»¶çš„æ–¹æ³•
< template>
 < QueryConditions ref="RefQueryConditions">< /QueryConditions>
 < button @click="clickFun">æŸ¥è¯¢< /button>
< /template>
export default defineComponent({
  setup(props, context) {
     const RefQueryConditions = ref();
     const clickFun = (data: any) => {
        RefQueryConditions.value.sonFun('paginationSearch');  //  è§¦å‘å­ç»„ä»¶æ–¹æ³•
     }
      return{
          btnItem,
          clickFun
      }
  }
})</pre>
          <h3>è¿‡æ»¤å™¨</h3>
          <pre>
åœ¨3.xä¸­ï¼Œè¿‡æ»¤å™¨è¢«åˆ é™¤ï¼Œä¸å†å—æ”¯æŒã€‚å»ºè®®ç”¨æ–¹æ³•è°ƒç”¨æˆ–è®¡ç®—å±æ€§æ›¿æ¢å®ƒä»¬ã€‚
< template>
 < h1>filter - {{myFilteræ‹¬å·valsæ‹¬å· }}< /h1>
< /template>
import {myFilter} from "@/utils/commonUtil";
export default defineComponent({
  setup(props, context) {
     const vals = '100';
      return{
          vals,
          myFilter
      }
  }
})
@/utils/commonUtil
function myFilter (data: string){   // æåˆ°ä¸€ä¸ªjsæ–‡ä»¶é‡Œï¼Œå˜æˆå…¨å±€è¿‡æ»¤æ–¹æ³•
   return  val + 'å…ƒ';
}
export {
   myFilter
}
        </pre>
          <h3>è·¯ç”±</h3>
          <pre>
vue2ä¸­çš„ï¼ˆ*ï¼‰ä¸é€‚ç”¨äºvue3ï¼Œvue3é…ç½®404é¡µé¢æ”¹ä¸ºå¦‚ä¸‹
{
    path: '/:catchAll(.*)',
    name: '/404',
    component: noFind
}
//  é¡µé¢è·³è½¬
const router = useRouter();
router.push('/newApplication?type=2');
        </pre>
          <h3>vuexçš„å†™æ³•</h3>
          <pre>
vue3.0çš„å†™æ³•ç¡®å®æ˜¯æ¯”2.0å†™æ³•ç®€ä¾¿ï¼Œå°¤å…¶æ˜¯æŒ‚è½½storeå’Œå£°æ˜storeçš„æ—¶å€™ï¼Œç›´æ¥ç”¨createStoreï¼ŒuseStoreå°±æå®šäº†

store.tsæ–‡ä»¶
import { createStore } from 'vuex'
import { getStorage } from '../api/storage'
export default createStore({
  state: {
     userInfo:getStorage('loginInfo'),
     roleId:getStorage('loginInfo')?getStorage('loginInfo').roleInfo[0].roleId:null,
     roleName:getStorage('loginInfo')?getStorage('loginInfo').roleInfo[0].roleName:null,
     projectName : 'os-demo',
     msgNum : 2
  },
  mutations: {
     setRoleInfo(state,data){
       state.roleId = data.roleId;
       state.roleName = data.roleName;
       state.msgNum ++;
     },
      setUserInfo(state,data){
          state.userInfo = data;
      }
  },
  actions: {
  },
  getters:{
    setMsgNum(state){
        return state.msgNum * state.msgNum;
    }
  },
  modules: {
  }
})

main.tsæ–‡ä»¶
import App from './App.vue'
import router from './router'
import store from './store'
const app = createApp(App);
app.use(store).use(router).use(Antd).mount('#app')

ç»„ä»¶
< template>
< span class="msgNum">{ {store.getters.setMsgNum}}< /span>
< /template>
< script>
  import { useStore } from "vuex";
  import { reactive,, computed } from "vue";
  const state = reactive({
        name: ''
      })
  const store = useStore();
  state.name = store.state.Name;
  const userName = computed(():any=>{ return store.state.userInfo.userName });
  function initMenu(loginInfo) {
      store.commit('setRoleInfo',loginInfo.roleInfo[index]);
  }< /script>
</pre>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
  export default {
    name: 'vue',
    data() {
      return {
        created: this.$route.query.created,
        title: this.$route.query.name,
        catalogue: []
      }
    },
    created() {

    },
    mounted: function () {
      this.$nextTick(function () {
        this.createCatalogue();

      })
    },
    computed: {},
    methods: {
      jump(index) {
//        let jump = document.getElementsByTagName('h3');
//       // è·å–éœ€è¦æ»šåŠ¨çš„è·ç¦»
//        let total = jump[index].offsetTop;
//        // Chrome
//        document.body.scrollTop = total;
//        // Firefox
//        document.documentElement.scrollTop = total;
//       // Safari
//        window.pageYOffset = total
//        https://www.cnblogs.com/wisewrong/p/6495726.html  å‚è€ƒç½‘ç«™
        let jump = document.getElementsByTagName('h3');
        let total = jump[index].offsetTop;  // è·å–ç›®æ ‡ä½ç½®æ»šåŠ¨çš„è·ç¦»
        let distance = document.documentElement.scrollTop || document.body.scrollTop; //è·å–å½“å‰æ»šåŠ¨è½´çš„ä½ç½®
        // å¹³æ»‘æ»šåŠ¨ï¼Œæ—¶é•¿500msï¼Œæ¯10msä¸€è·³ï¼Œå…±50è·³
        let step = total / 50;
        if (total > distance) {
          smoothDown()
        } else {
          let newTotal = distance - total;  //é˜²æ­¢totalï¼Œlet step=total/50å¤ªå°ï¼Œç§»åŠ¨ç¼“æ…¢
          step = newTotal / 50;
          smoothUp()
        }

        function smoothDown() {
          if (total > distance) {
            distance += step;
            document.body.scrollTop = distance;
            document.documentElement.scrollTop = distance;
            setTimeout(smoothDown, 10)
          } else {
            document.body.scrollTop = total;
            document.documentElement.scrollTop = total
          }
        }

        function smoothUp() {
          if (total < distance) {
            distance -= step;
            document.body.scrollTop = distance;
            document.documentElement.scrollTop = distance;
            setTimeout(smoothUp, 10)
          } else {
            document.body.scrollTop = total;
            document.documentElement.scrollTop = total
          }
        }
      },
      //åˆ›å»ºç›®å½•å‡½æ•°
      createCatalogue() {
        let object = document.getElementsByTagName('h3');
        var flag = [];
        for (var i = 0; i < object.length; i++) {
          var o = {name: object[i].innerHTML};
          flag.push(o)
        }
        this.catalogue = flag;
      }
    }
  }
</script>
<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped>

</style>
